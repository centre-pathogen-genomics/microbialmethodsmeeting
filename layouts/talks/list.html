{{ define "main" }}
<div class="container">

    {{ $pages := .Pages }}
    {{ $upcoming := where $pages "Date" "ge" now }}
    {{ $past := where $pages "Date" "lt" now }}

    <h2>Upcoming Talks</h2>
    <div class="upcoming-list">
    {{ range $upcoming.Reverse }}
        <div class="card mb-3">
            <div class="card-body">
                {{ with .Params.speakers }}
                <div class="speakers mb-3">
                    <ul class="list-unstyled mb-0">
                    {{ range . }}
                        <li class="mb-2">
                            <h3 class="card-title mb-1">
                                {{ if .url }}
                                    <a href="{{ .url }}" target="_blank" rel="noopener" class="text-decoration-none text-reset">{{ .name }}</a>
                                {{ else }}
                                    {{ .name }}
                                {{ end }}
                            </h3>
                            <h4 class="card-subtitle text-body-secondary">{{ .topic | markdownify }}</h4>
                        </li>
                    {{ end }}
                    </ul>
                </div>
                {{ end }}

                <h5 class="mb-2">
                    {{ .Date.Format "Monday, 2 January 2006" }}
                </h5>
                
                {{ if .Params.location }}
                <p class="card-text text-muted small">
                    <i class="bi bi-geo-alt-fill"></i> 
                    {{ if .Params.location_url }}
                        <a href="{{ .Params.location_url }}" target="_blank" rel="noopener" class="text-muted">{{ .Params.location }}</a>
                    {{ else }}
                        {{ .Params.location }}
                    {{ end }}
                </p>
                {{ end }}
            </div>
        </div>
    {{ else }}
        <p>No upcoming talks scheduled.</p>
    {{ end }}
    </div>

    <hr>

    <h2>Previous Talks</h2>
    <div class="past-list">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th scope="col" style="width: 70%;">Presenters & Topics</th>
                    <th scope="col" style="width: 30%;">Date</th>
                </tr>
            </thead>
            <tbody>
            {{ range $past }}
                <tr>
                    <td>
                        {{ range $index, $element := .Params.speakers }}
                            {{ if $index }}<br>{{ end }}
                            <strong>{{ .name }}</strong><br>
                            <span class="text-muted">{{ .topic | markdownify }}</span>
                        {{ end }}
                    </td>
                    <td class="align-middle text-muted">{{ .Date.Format "2006-01-02" }}</td>
                </tr>
            {{ end }}
            </tbody>
        </table>
    </div>
</div>
{{ end }}
